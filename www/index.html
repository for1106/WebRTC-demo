<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>WebRTC</title>
	<link rel="stylesheet" href="css/dist/css/bootstrap.min.css">
	<style>
		video {
			position: fixed;
			top: 0;
			left: 0;
			min-width: 100%;
			min-height: 100%;
			z-index: -100;
		}
		pre {
			font-family: 'Courier New', 'Courier', monospace;
			font-size: 10px;
			line-height: 10px;
			letter-spacing: -1.5px;
			text-align: center;
		}
	</style>
</head>
<body>

<div class="container">
	<div class="row">
		<div class="col-sm-12 well">
			<div class="form-group">
				<label class="control-label">Room</label>
				<div class="input-group">
					<input type="text" class="form-control" id="channel_input">
					<span class="input-group-btn">
						<button class="btn btn-primary" id="broadcast_button">Broadcast</button>
					</span>
					<span class="input-group-btn">
						<button class="btn btn-primary" id="watch_button">Watch</button>
					</span>
				</div>
			</div>
		</div>
		<video id="video" autoplay></video>
		<!-- <pre id="ascii"></pre> -->
	</div>
</div>

<script src="js/jquery-3.0.0.min.js"></script>
<script src="js/server.js"></script>
<script src="js/client.js"></script>
<!-- <script src="js/ascii.js"></script> -->

<script src="/socket.io/socket.io.js"></script>
<script src="/webrtc-adapter/out/adapter.js"></script>

<script>
 	var video = $('#video'),
		channel_input = $('#channel_input'),
		broadcast_button = $('#broadcast_button'),
		watch_button = $('#watch_button');

	var socket = io();
	socket.on('change_candidate',change_candidate);
	socket.on('change_data',change_data);
	socket.on('request_offer',request_offer);
	socket.on('response_answer',response_answer);

	broadcast_button.on('click',start_broadcast);
	watch_button.on('click',start_watch);

	function log_msg(msg){
		console.log(msg);
	}

	// var init_canvas = (function(use_ascii){
	// 	var ascii_container,canvas,context,
	// 		well = $('.well'),
	// 		width = 160,
	// 		height = 120,
	// 		fps = 30;

	// 	if(!use_ascii){
	// 		video = $('<video autoplay>').insertAfter(well);
	// 	}else{
	// 		ascii_container = $('<pre>').insertAfter(well);
	// 		video = $('<video>').width(width).height(height);
	// 		canvas = $('<canvas>').width(width).height(height);
	// 	}

	// 	function init(){
	// 		video[0].play();

	// 		context = canvas[0].getContext('2d');
	// 		context.translate(canvas.width(), 0);
	// 		context.scale(-1, 1);

	// 		setInterval(function(){
	// 			context.drawImage(video[0], 0, 0, video.width(), video.height());

	// 			ascii.fromCanvas(canvas,{
	// 				callback:function(asciiString) {
	// 					ascii_container.html(asciiString);
	// 				}
	// 			});
	// 		},Math.round(1000/fps));
	// 	}

	// 	return !use_ascii ? function(){} : init;
	// })(false);
</script>
</body>
</html>